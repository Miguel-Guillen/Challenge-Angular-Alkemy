<app-navbar></app-navbar>
<div class="container-fluid bg-cont p-4 min-vh-100">
  <div class="row d-flex justify-content-center">

    <!-- buscador -->
    <div class="col-12 fs p-0">
      <form [formGroup]="busquedaForm" (ngSubmit)="buscar(busquedaForm.value)">
        <div class="d-flex col-12 col-md-6">
          <input type="search" class="form-control bg-light d-inline" minlength="3"
          placeholder="ejemplo: batman" formControlName="nombre" maxlength="30">
          <button class="btn bg-light border border-1 ms-1"><i class="fas fa-search"></i></button>
        </div>
        <div class="text-danger">
          <ng-container *ngFor="let validation of validation_messages.nombre">
            <div *ngIf="busquedaForm.get('nombre')?.hasError(validation.type) && 
            (busquedaForm.get('nombre')?.dirty || busquedaForm.get('nombre')?.touched)">
              {{validation.message}}
            </div>
            <div *ngIf="busquedaForm.get('nombre')?.hasError('minlength')">
              se requiere de al menos 3 caracteres
            </div>
          </ng-container>
        </div>
      </form>
    </div>

    <!-- Equipo actual -->
      <div class="col mt-3 mb-1 fs" *ngIf="equipo.length != 0; else noTeam" id="equipo">
        <h6 class="text-white">Integrantes de mi equipo</h6>
        <div class="row mx-md-2">
          <div class="col-2 px-0 pt-2" *ngFor="let e of equipo$ | async">
            <div class="mx-1">
              <img src="{{e.image.url}}" class="img-fluid rounded-circle" alt=""
              [ngClass]="{'border-villain': e.biography.alignment == 'bad', 
              'border-heroe': e.biography.alignment == 'good'}">
            </div>
            <p class="text-center px-0">{{ (e.name.length > 7)? (e.name | slice: 0:5)
              + '..' : (e.name) }}</p>
          </div>
        </div>
      </div>

      <!-- resultados de busqueda -->
      <div class="col-12" *ngIf="superheroe.length > 0">
        <p class="fw-bold m-1 fs">
          Resultados encontrados: {{superheroe.length}}
        </p>
        <div class="row d-flex fs text-dark" [ngClass]="superheroe.length > 1 ?
          'justify-content-evenly' : 'justify-content-between' ">
          <div class="col-5 col-md-3 col-xl-2 bg-light rounded p-2 mx-2 my-1" 
          *ngFor="let s of superheroe">
            <div class="text-center">
              <img src="{{s.image.url}}" class="image border border-dark border-3" alt="...">
            </div>
            <div class="mx-1 mt-2 text-center">
              <h6 class="fw-bold mx-0 my-1">{{s.name}}</h6>
              <p class="mx-0 my-1">Afiliacion: {{s.biography.alignment}}</p>
            </div>
            <div class="my-auto d-flex justify-content-center m-1">
              <button class="btn btn-outline-success me-1 fs text-success" 
              (click)="agregar(s.id)">Añadir</button>
              <button class="btn btn-outline-info" (click)="detalles(s.id)">
                <i class="fas fa-info-circle"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
  </div>
</div>
<app-footer></app-footer>

<ng-template #noTeam>
  <div class="px-3 fs">
    <h4 class="text-white my-4">No cuenta con ningun heroe en su equipo</h4>
    <p class="text-white">Para añadir un nuevo heroe, escriba en el buscador el 
      nombre del heroe que desea añadir
    </p>
  </div>
</ng-template>